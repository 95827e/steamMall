# steamMall
基于SpringBoot+Mybatis开发的主从架构的Steam商城（开发ing...）
# 架构以及详细实现
## 1.登录注册
* 两次md5,对密码加密
* 分布式session，将用户的登录信息缓存在redis中
* 权限检查，每次操作在权限允许下才能进行
* 注册，需要邮箱验证码，邮箱验证码会在缓存中存在90s的时间
* 拦截器对静态资源文件以及后台未经登录的拦截

## 2.页面数据
* 首页及其他页面因为读多写少，利用Mysql主从复制实现读写分离，写入在主Mysql下进行，读取在从Mysql进行
* 关于数据的不一致性，可以在写入的时候先写入缓存，读取的时候也先在缓存中读取，这样就可以避免数据的不一致性
* 缓存利用Redis，内存满的情况下，键的删除策略采用volatile-lru
* 热卖榜依据Redis的zset实现，缓存时间为30s
* 图片、静态页面等静态资源由Nginx加载

## 3.秒杀功能
原理：尽量减少Mysql的访问
* 将先将需要秒杀的数据缓存在Redis中，在秒杀接口里做预减少库存
* 判断订单里有无对应的信息
* 将user信息与秒杀资源信息加入消息队列中
* 消息接受者减少库存，新增订单，将订单信息加入缓存，设置30s过期时间
* 客户端不断轮询缓存，直到秒杀成功

## 4.页面缓存以及静态化
* 大部分的页面经过静态化处理，并发布在nginx静态资源服务器上
* 加载从nginx中取出放入缓存，10s过期，后先从缓存中取出

## 5. 主从配置
https://my.oschina.net/wenjinglian/blog/1502414

## 6.消息队列
